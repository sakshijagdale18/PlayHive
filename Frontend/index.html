<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Play Hive ‚Äî Game Portal</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'ph-light': '#f8fafc',
            'ph-dark': '#061425',
            'ph-blue': '#0b3d91',
            'ph-accent': '#00bfa5',
            'ph-purple': '#6b3cff',
            'ph-gray': '#e2e8f0'
          },
          keyframes: {
            floaty: {
              '0%': { transform: 'translateY(0px)' },
              '50%': { transform: 'translateY(-12px)' },
              '100%': { transform: 'translateY(0px)' }
            },
            pulseGlow: {
              '0%,100%': { boxShadow: '0 0 10px #ff4fd8' },
              '50%': { boxShadow: '0 0 25px #ff99ff' }
            }
          },
          animation: {
            floaty: 'floaty 6s ease-in-out infinite',
            pulseGlow: 'pulseGlow 3s ease-in-out infinite'
          }
        }
      }
    }
  </script>

  <style>
    html, body { height: 100%; margin: 0; overflow-x: hidden; }
    body {
      font-family: 'Poppins', system-ui, sans-serif;
      color: #111827;
      position: relative;
      overflow-x: hidden;
    }

    #background-wrapper {
      position: fixed;
      inset: 0;
      overflow: hidden;
      z-index: 0;
    }

    #orb {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 900px;
      height: 900px;
      margin-top: -450px;
      margin-left: -450px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255,105,180,0.4), rgba(255,20,147,0.1), transparent 70%);
      filter: blur(100px);
      animation: rotateOrb 25s linear infinite;
    }

    @keyframes rotateOrb {
      0% { transform: rotate(0deg) scale(1); }
      50% { transform: rotate(180deg) scale(1.1); }
      100% { transform: rotate(360deg) scale(1); }
    }

    #particle-canvas {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
    }

    .glass {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(12px) saturate(140%);
      border: 1px solid rgba(0,0,0,0.05);
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
    }

    .card-hover {
      transition: all .3s ease;
    }

    .card-hover:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 12px 30px rgba(0,0,0,0.15);
    }

    .logo-gradient {
      background: conic-gradient(from 180deg at 50% 50%, #ff4fd8, #6b3cff, #00bfff, #ff4fd8);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .featured-tag {
      position: absolute;
      top: 1rem;
      left: -1.5rem;
      background: linear-gradient(90deg, #ff4fd8, #6b3cff);
      color: white;
      font-size: 0.75rem;
      font-weight: 700;
      padding: 0.4rem 2rem;
      transform: rotate(-45deg);
      box-shadow: 0 2px 8px rgba(0,0,0,0.25);
      text-transform: uppercase;
      letter-spacing: 1px;
      border-top-left-radius: 4px;
      border-top-right-radius: 4px;
      animation: pulseRibbon 3s ease-in-out infinite;
    }

    @keyframes pulseRibbon {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(1.3); }
    }

    .focus-ring:focus {
      outline: none;
      box-shadow: 0 0 0 6px rgba(255,79,216,0.15);
      border-radius: 9999px;
    }

    /* Profile Dropdown */
    .dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-menu {
      display: none;
      position: absolute;
      right: 0;
      margin-top: 0.5rem;
      background-color: white;
      min-width: 10rem;
      border-radius: 0.5rem;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      z-index: 50;
    }

    .dropdown-menu.show {
      display: block;
    }

    .dropdown-link {
      display: block;
      padding: 0.75rem 1rem;
      font-size: 0.9rem;
      color: #374151;
      transition: background 0.2s ease;
      cursor: pointer;
      text-decoration: none;
      border: none;
      background: none;
      width: 100%;
      text-align: left;
    }

    .dropdown-link:hover {
      background: rgba(255, 192, 203, 0.15);
      color: #d63384;
    }

    /* Loading spinner */
    .loading-spinner {
      border: 2px solid #f3f4f6;
      border-top: 2px solid #ec4899;
      border-radius: 50%;
      width: 1rem;
      height: 1rem;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>

<body>
  <div id="background-wrapper">
    <div id="orb"></div>
    <canvas id="particle-canvas"></canvas>
  </div>

  <header class="w-full fixed top-0 left-0 z-40">
    <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between glass">
      <a href="index.html" class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-full bg-gradient-to-br from-ph-purple to-pink-500 flex items-center justify-center shadow-lg">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
            <path d="M12 2 L16 6 L12 10 L8 6 Z" fill="white" opacity="0.95"/>
            <circle cx="12" cy="14" r="4" fill="white" opacity="0.95"/>
          </svg>
        </div>
        <span class="text-xl font-semibold logo-gradient">Play Hive</span>
      </a>

      <div class="flex items-center gap-4">
        <a href="index.html" class="hidden sm:inline-block text-sm px-3 py-2 rounded-md hover:bg-black/5">Home</a>
        <a href="games.html" class="hidden sm:inline-block text-sm px-3 py-2 rounded-md hover:bg-black/5">Games</a>
        <a href="allrulebook.html" class="hidden sm:inline-block text-sm px-3 py-2 rounded-md hover:bg-black/5">Rule Books</a>
       

        <!-- User Welcome & Profile Dropdown -->
        <div id="userSection" class="flex items-center gap-3">
          <span id="welcomeMessage" class="text-pink-600 font-semibold hidden"></span>
          
          <!-- Profile Dropdown -->
          <div class="dropdown">
            <button id="dropdownButton" class="focus-ring">
              <img src="https://cdn-icons-png.flaticon.com/512/847/847969.png" alt="Profile" class="w-9 h-9 rounded-full border border-gray-300 hover:brightness-110">
            </button>
            <div id="dropdownMenu" class="dropdown-menu">
             
              <button id="logoutBtn" class="dropdown-link w-full text-left">üîë Logout</button>
            </div>
          </div>
        </div>
      </div>
    </nav>
  </header>

  <!-- Loading Screen -->
  <div id="loadingScreen" class="fixed inset-0 bg-white z-50 flex items-center justify-center">
    <div class="text-center">
      <div class="loading-spinner mx-auto mb-4"></div>
      <p class="text-gray-600">Loading Play Hive...</p>
    </div>
  </div>

  <main class="pt-28 relative z-10" id="mainContent" style="display: none;">
    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
      <div class="space-y-6">
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-pink-200/20 w-max">
          <span class="text-xs font-semibold text-pink-500">FEATURED</span>
          <span class="text-xs opacity-70">Top Picks of the Week</span>
        </div>

        <h1 class="text-4xl sm:text-5xl font-extrabold leading-tight">
          Level Up Your <span class="text-pink-500">Gaming</span> Journey
        </h1>

        <p class="text-gray-700 max-w-xl">
          Compete in featured tournaments and play trending games. Earn, enjoy, and rise to the top of the leaderboard at <span class="text-pink-500 font-semibold">Play Hive</span>.
        </p>

        <div class="flex gap-3">
          <a href="aboutus.html" class="px-5 py-3 rounded-lg border border-black/10 hover:bg-black/5 focus-ring">About Us</a>
          <a href="features.html" class="px-5 py-3 rounded-lg bg-pink-500 text-white font-semibold hover:brightness-110 focus-ring">Our Features</a>
        </div>
      </div>

      <div class="grid grid-cols-1 gap-6">
        <div class="glass p-5 relative card-hover">
          <div class="featured-tag">Featured</div>
          <img src="media/EVrIUuIX0AIKOgr.png" class="rounded-xl mb-4 h-48 w-full object-cover" alt="Shape Shifter Game" />
          <h3 class="text-2xl font-bold text-pink-600 mb-1">üòé Emoji Decoder</h3>
          <p class="text-gray-600 text-sm mt-2 leading-relaxed">
           Decode emoji puzzles to reveal hidden phrases and idioms! Example: üêù‚ûïüçØ = "Be Sweet." Test your emoji logic!
          </p>
          <div class="flex justify-between mt-5">
            <a href="emojidecoder.html" class="px-4 py-2 bg-pink-500 text-white rounded-lg hover:brightness-110">Play Now</a>
            <a href="emojiedecoderrulebook.html" class="px-4 py-2 border border-pink-500 text-pink-500 rounded-lg hover:bg-pink-50">View Rules</a>
          </div>
        </div>

        <div class="glass p-5 relative card-hover">
          <div class="featured-tag">Featured</div>
          <img src="media/mindloop.jpeg" class="rounded-xl mb-4 h-48 w-full object-cover" alt="Syntax Sprint Game" />
          <h3 class="text-2xl font-bold text-pink-600 mb-1">üß† Mind Loop</h3>
          <p class="text-gray-600 text-sm mt-2 leading-relaxed">
            Remember glowing tile sequences before they fade. Each round gets faster ‚Äî can your memory keep up?
          </p>
          <div class="flex justify-between mt-5">
            <a href="mindloop.html" class="px-4 py-2 bg-pink-500 text-white rounded-lg hover:brightness-110">Play Now</a>
            <a href="mindlooprulebook.html" class="px-4 py-2 border border-pink-500 text-pink-500 rounded-lg hover:bg-pink-50">View Rules</a>
          </div>
        </div>
      </div>
    </section>

    <footer class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 text-sm text-gray-500">
      <div class="flex flex-col md:flex-row justify-between gap-6 items-start md:items-center">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-full bg-gradient-to-br from-pink-500 to-purple-500 flex items-center justify-center">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M12 2 L16 6 L12 10 L8 6 Z" fill="white"/></svg>
          </div>
          <div>
            <div class="font-semibold text-gray-900">Play Hive</div>
            <div class="text-xs opacity-70">¬© <span id="year"></span> All Rights Reserved</div>
            <a href="admin-panel.html" class="text-xs text-pink-500 hover:underline">üîë Admin Login</a>
          </div>
        </div>
      </div>
    </footer>
  </main>

  <script>
    // document.getElementById('year').textContent = new Date().getFullYear();

    // // üü¢ ENHANCED Session management
    // async function checkAuthentication() {
    //   const userData = localStorage.getItem('userData');
      
    //   if (!userData) {
    //     // Not logged in, redirect to login page
    //     console.log('No user data found, redirecting to login');
    //     window.location.href = 'login.html';
    //     return null;
    //   }

    //   try {
    //     const user = JSON.parse(userData);
    //     console.log('User data found:', user);
        
    //     // Verify session with backend
    //     try {
    //       const res = await fetch('http://localhost:8088/api/users/session', {
    //         method: 'GET',
    //         credentials: 'include'
    //       });
          
    //       if (res.ok) {
    //         const sessionData = await res.json();
    //         console.log('Session verified:', sessionData);
    //         return sessionData.user || user;
    //       } else {
    //         console.log('Session invalid, clearing local storage');
    //         localStorage.removeItem('userData');
    //         localStorage.removeItem('lastLogin');
    //         window.location.href = 'login.html';
    //         return null;
    //       }
    //     } catch (error) {
    //       console.log('Backend unavailable, using cached data');
    //       return user; // Use cached data if backend is down
    //     }
    //   } catch (error) {
    //     console.error('Error parsing user data:', error);
    //     localStorage.removeItem('userData');
    //     localStorage.removeItem('lastLogin');
    //     window.location.href = 'login.html';
    //     return null;
    //   }
    // }

    // // Initialize page
    // async function initializePage() {
    //   const user = await checkAuthentication();
      
    //   if (user) {
    //     // Show welcome message
    //     const welcomeMessage = document.getElementById('welcomeMessage');
    //     welcomeMessage.textContent = `üëã Hello, ${user.username}`;
    //     welcomeMessage.classList.remove('hidden');
        
    //     // Hide loading screen and show main content
    //     document.getElementById('loadingScreen').style.display = 'none';
    //     document.getElementById('mainContent').style.display = 'block';
        
    //     console.log('Page initialized for user:', user.username);
    //   }
    // }

    // // Logout function
    // async function logout() {
    //   try {
    //     await fetch('http://localhost:8088/api/users/logout', {
    //       method: 'POST',
    //       credentials: 'include'
    //     });
    //   } catch (error) {
    //     console.log('Logout API call failed, continuing with client-side logout');
    //   }
      
    //   // Clear all storage and redirect
    //   localStorage.removeItem('userData');
    //   localStorage.removeItem('lastLogin');
    //   sessionStorage.clear();
      
    //   window.location.href = 'login.html';
    // }

    // // Dropdown toggle
    // function setupDropdown() {
    //   const dropdownButton = document.getElementById('dropdownButton');
    //   const dropdownMenu = document.getElementById('dropdownMenu');
      
    //   if (dropdownButton && dropdownMenu) {
    //     dropdownButton.addEventListener('click', (e) => {
    //       e.stopPropagation();
    //       dropdownMenu.classList.toggle('show');
    //     });
        
    //     document.addEventListener('click', (e) => {
    //       if (!dropdownMenu.contains(e.target) && !dropdownButton.contains(e.target)) {
    //         dropdownMenu.classList.remove('show');
    //       }
    //     });
    //   }
    // }

    // // Event listeners
    // document.addEventListener('DOMContentLoaded', function() {
    //   initializePage();
    //   setupDropdown();
      
    //   // Logout button
    //   const logoutBtn = document.getElementById('logoutBtn');
    //   if (logoutBtn) {
    //     logoutBtn.addEventListener('click', logout);
    //   }
    // });

    // // Particle animation
    // const canvas = document.getElementById('particle-canvas');
    // const ctx = canvas.getContext('2d');
    // let particles = [];

    // function resizeCanvas() {
    //   canvas.width = window.innerWidth;
    //   canvas.height = window.innerHeight;
    // }
    // window.addEventListener('resize', resizeCanvas);
    // resizeCanvas();

    // const numParticles = 90;
    // for (let i = 0; i < numParticles; i++) {
    //   particles.push({
    //     x: Math.random() * canvas.width,
    //     y: Math.random() * canvas.height,
    //     vx: (Math.random() - 0.5) * 0.6,
    //     vy: (Math.random() - 0.5) * 0.6,
    //     radius: 1.5 + Math.random() * 1.5
    //   });
    // }

    // function animate() {
    //   ctx.clearRect(0, 0, canvas.width, canvas.height);
    //   for (let p of particles) {
    //     p.x += p.vx;
    //     p.y += p.vy;
    //     if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
    //     if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
    //   }

    //   for (let i = 0; i < particles.length; i++) {
    //     const p1 = particles[i];
    //     ctx.beginPath();
    //     ctx.arc(p1.x, p1.y, p1.radius, 0, Math.PI * 2);
    //     ctx.fillStyle = 'rgba(255, 105, 180, 0.8)';
    //     ctx.fill();
    //     for (let j = i + 1; j < particles.length; j++) {
    //       const p2 = particles[j];
    //       const dist = Math.hypot(p1.x - p2.x, p1.y - p2.y);
    //       if (dist < 120) {
    //         ctx.strokeStyle = 'rgba(255, 105, 180,' + (1 - dist / 120) + ')';
    //         ctx.lineWidth = 0.5;
    //         ctx.beginPath();
    //         ctx.moveTo(p1.x, p1.y);
    //         ctx.lineTo(p2.x, p2.y);
    //         ctx.stroke();
    //       }
    //     }
    //   }
    //   requestAnimationFrame(animate);
    // }
    // animate();

    document.getElementById('year').textContent = new Date().getFullYear();

// üü¢ SIMPLIFIED Session management
function checkAuthentication() {
    const userData = localStorage.getItem('userData');
    
    if (!userData) {
        // Not logged in, redirect to login page
        console.log('No user data found, redirecting to login');
        window.location.href = 'login.html';
        return null;
    }

    try {
        const user = JSON.parse(userData);
        console.log('User data found:', user);
        return user;
    } catch (error) {
        console.error('Error parsing user data:', error);
        localStorage.removeItem('userData');
        localStorage.removeItem('lastLogin');
        window.location.href = 'login.html';
        return null;
    }
}

// Initialize page
function initializePage() {
    const user = checkAuthentication();
    
    if (user) {
        // Show welcome message
        const welcomeMessage = document.getElementById('welcomeMessage');
        welcomeMessage.textContent = `üëã Hello, ${user.username}`;
        welcomeMessage.classList.remove('hidden');
        
        // Hide loading screen and show main content
        document.getElementById('loadingScreen').style.display = 'none';
        document.getElementById('mainContent').style.display = 'block';
        
        console.log('Page initialized for user:', user.username);
    }
}

// Logout function
async function logout() {
    try {
        await fetch('http://localhost:8088/api/users/logout', {
            method: 'POST',
            credentials: 'include'
        });
    } catch (error) {
        console.log('Logout API call failed, continuing with client-side logout');
    }
    
    // Clear all storage and redirect
    localStorage.removeItem('userData');
    localStorage.removeItem('lastLogin');
        localStorage.removeItem('userEmail'); // ‚Üê ADD THIS LINE
    localStorage.clear();
    sessionStorage.clear();
    
    window.location.href = 'login.html';
}

// Dropdown toggle
function setupDropdown() {
    const dropdownButton = document.getElementById('dropdownButton');
    const dropdownMenu = document.getElementById('dropdownMenu');
    
    if (dropdownButton && dropdownMenu) {
        dropdownButton.addEventListener('click', (e) => {
            e.stopPropagation();
            dropdownMenu.classList.toggle('show');
        });
        
        document.addEventListener('click', (e) => {
            if (!dropdownMenu.contains(e.target) && !dropdownButton.contains(e.target)) {
                dropdownMenu.classList.remove('show');
            }
        });
    }
}

// Event listeners
document.addEventListener('DOMContentLoaded', function() {
    initializePage();
    setupDropdown();
    
    // Logout button
    const logoutBtn = document.getElementById('logoutBtn');
    if (logoutBtn) {
        logoutBtn.addEventListener('click', logout);
    }
});

// Particle animation
const canvas = document.getElementById('particle-canvas');
const ctx = canvas.getContext('2d');
let particles = [];

function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

const numParticles = 90;
for (let i = 0; i < numParticles; i++) {
    particles.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        vx: (Math.random() - 0.5) * 0.6,
        vy: (Math.random() - 0.5) * 0.6,
        radius: 1.5 + Math.random() * 1.5
    });
}

function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (let p of particles) {
        p.x += p.vx;
        p.y += p.vy;
        if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
        if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
    }

    for (let i = 0; i < particles.length; i++) {
        const p1 = particles[i];
        ctx.beginPath();
        ctx.arc(p1.x, p1.y, p1.radius, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(255, 105, 180, 0.8)';
        ctx.fill();
        for (let j = i + 1; j < particles.length; j++) {
            const p2 = particles[j];
            const dist = Math.hypot(p1.x - p2.x, p1.y - p2.y);
            if (dist < 120) {
                ctx.strokeStyle = 'rgba(255, 105, 180,' + (1 - dist / 120) + ')';
                ctx.lineWidth = 0.5;
                ctx.beginPath();
                ctx.moveTo(p1.x, p1.y);
                ctx.lineTo(p2.x, p2.y);
                ctx.stroke();
            }
        }
    }
    requestAnimationFrame(animate);
}
animate();
  </script>
</body>
</html>